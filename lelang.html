<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lelang Gadget | Klik Second</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="auth-modal.css">
  <link rel="stylesheet" href="notification.css">
  <link rel="stylesheet" href="lelang-style.css">
  <!-- TAMBAHKAN CSS DEPOSIT MODAL -->
  <link rel="stylesheet" href="deposit-modal.css">
</head>
<body>
  <div id="particles-js"></div>

  <!-- HEADER -->
  <header class="header">
    <nav class="navbar">
      <img src="LogoKlikSecondTransparent.png" class="logo" alt="Klik Second" onclick="window.location.href='index.html'" style="cursor: pointer;">

      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="search.html">Cari Produk</a></li>
        <li><a href="lelang.html" class="active">Lelang</a></li>
        <li><a href="pegadaian.html">Pegadaian</a></li>
        <li><a href="about.html">About Us</a></li>
      </ul>

      <!-- Auth Buttons (shown when not logged in) -->
      <div class="auth-buttons">
        <button class="btn-login">Login</button>
        <button class="btn-register">Daftar</button>
      </div>

      <!-- User Profile Section (shown when logged in) -->
      <div class="user-profile-section">
        <button class="notification-btn">
          <i class="bi bi-bell-fill"></i>
          <span class="notification-badge">0</span>
        </button>

        <div class="user-profile-trigger">
          <img src="https://ui-avatars.com/api/?name=User&background=00ffff&color=000" alt="User" class="user-avatar">
          <div class="user-info">
            <span class="user-name">User Name</span>
            <span class="user-role">Seller</span>
          </div>
          <i class="bi bi-chevron-down dropdown-arrow"></i>
        </div>

        <div class="user-dropdown">
          <a href="profile.html?tab=profile" class="dropdown-item">
            <i class="bi bi-person-circle"></i>
            <span>Profile Saya</span>
          </a>
          <a href="profile.html?tab=products" class="dropdown-item">
            <i class="bi bi-box-seam"></i>
            <span>Produk Saya</span>
          </a>
          <a href="profile.html?tab=auctions" class="dropdown-item">
            <i class="bi bi-gavel"></i>
            <span>Lelang Saya</span>
          </a>
          <a href="profile.html?tab=pawnshop" class="dropdown-item">
            <i class="bi bi-gem"></i>
            <span>Pegadaian Saya</span>
          </a>          
          <a href="profile.html?tab=settings" class="dropdown-item">
            <i class="bi bi-gear"></i>
            <span>Pengaturan</span>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item" id="logout-btn">
            <i class="bi bi-box-arrow-right"></i>
            <span>Keluar</span>
          </a>
        </div>
      </div>
    </nav>
  </header>

  <!-- NOTIFICATION PANEL -->
  <div id="notification-panel" class="notification-panel">
    <div class="notification-header">
      <h3><i class="bi bi-bell-fill"></i> Notifikasi</h3>
      <div class="notification-actions">
        <button class="mark-all-read">Tandai Semua</button>
        <button class="close-notification">
          <i class="bi bi-x"></i>
        </button>
      </div>
    </div>
    <div class="notification-list" id="notification-list">
      <!-- Notifications will be loaded here -->
    </div>
  </div>

  <!-- AUTHENTICATION MODAL -->
  <div id="auth-modal" class="auth-modal">
    <div class="auth-modal-content">
      <span class="auth-modal-close">
        <i class="bi bi-x"></i>
      </span>

      <div class="auth-modal-header">
        <h2>Selamat Datang!</h2>
        <p>Login atau daftar untuk melanjutkan</p>
      </div>

      <div class="auth-tabs">
        <button class="auth-tab active" data-tab="login">Login</button>
        <button class="auth-tab" data-tab="register">Daftar</button>
      </div>

      <!-- LOGIN FORM -->
      <div id="login-form" class="auth-form active">
        <div id="login-error" class="error-message"></div>
        
        <form onsubmit="return false;">
          <div class="form-group">
            <label for="login-username">Username atau Email</label>
            <input type="text" id="login-username" placeholder="Masukkan username atau email" required>
          </div>

          <div class="form-group password-toggle">
            <label for="login-password">Password</label>
            <input type="password" id="login-password" placeholder="Masukkan password" required>
            <i class="bi bi-eye-slash password-toggle-icon"></i>
          </div>

          <div class="form-options">
            <label class="remember-me">
              <input type="checkbox" id="remember-me">
              <span>Ingat Saya</span>
            </label>
            <a href="#" class="forgot-password">Lupa Password?</a>
          </div>

          <button type="submit" class="auth-submit-btn">
            <i class="bi bi-box-arrow-in-right"></i>
            Login
          </button>
        </form>

        <div class="auth-divider">
          <span>atau login dengan</span>
        </div>

        <div class="social-login">
          <button class="social-btn">
            <i class="bi bi-google"></i>
            Google
          </button>
          <button class="social-btn">
            <i class="bi bi-facebook"></i>
            Facebook
          </button>
        </div>
      </div>

      <!-- REGISTER FORM -->
      <div id="register-form" class="auth-form">
        <div id="register-error" class="error-message"></div>
        <div id="register-success" class="success-message"></div>
        
        <form onsubmit="return false;">
          <div class="form-group">
            <label for="register-fullname">Nama Lengkap</label>
            <input type="text" id="register-fullname" placeholder="Masukkan nama lengkap" required>
          </div>

          <div class="form-group">
            <label for="register-email">Email</label>
            <input type="email" id="register-email" placeholder="Masukkan email" required>
          </div>

          <div class="form-group">
            <label for="register-phone">No. Telepon</label>
            <input type="tel" id="register-phone" placeholder="08XXXXXXXXXX" required>
          </div>

          <div class="form-group">
            <label for="register-username">Username</label>
            <input type="text" id="register-username" placeholder="Pilih username" required>
          </div>

          <div class="form-group password-toggle">
            <label for="register-password">Password</label>
            <input type="password" id="register-password" placeholder="Minimal 6 karakter" required>
            <i class="bi bi-eye-slash password-toggle-icon"></i>
          </div>

          <div class="form-group password-toggle">
            <label for="register-confirm-password">Konfirmasi Password</label>
            <input type="password" id="register-confirm-password" placeholder="Ulangi password" required>
            <i class="bi bi-eye-slash password-toggle-icon"></i>
          </div>

          <button type="submit" class="auth-submit-btn">
            <i class="bi bi-person-plus"></i>
            Daftar Sekarang
          </button>
        </form>
      </div>
    </div>
  </div>

  <!-- LELANG HERO SECTION -->
  <section class="lelang-hero">
    <div class="lelang-hero-content">
      <div class="hero-badge">
        <i class="bi bi-lightning-charge-fill"></i>
        <span>LIVE AUCTION</span>
      </div>
      <h1>Lelang Gadget Premium</h1>
      <p>Dapatkan gadget impianmu dengan harga terbaik melalui sistem lelang yang transparan dan aman</p>
      
      <div class="hero-countdown">
        <span class="countdown-label">Sesi Lelang Berakhir Dalam:</span>
        <div class="hero-timer">
          <div class="timer-item">
            <span class="timer-value" id="hero-hours">00</span>
            <span class="timer-label">Jam</span>
          </div>
          <span class="timer-colon">:</span>
          <div class="timer-item">
            <span class="timer-value" id="hero-minutes">00</span>
            <span class="timer-label">Menit</span>
          </div>
          <span class="timer-colon">:</span>
          <div class="timer-item">
            <span class="timer-value" id="hero-seconds">00</span>
            <span class="timer-label">Detik</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FILTER SECTION -->
  <section class="filter-section">
    <div class="filter-container">
      <div class="filter-item">
        <label>Kategori:</label>
        <select id="category-filter">
          <option value="all">Semua Kategori</option>
          <option value="iphone">iPhone</option>
          <option value="android">Android</option>
          <option value="tablet">Tablet</option>
        </select>
      </div>
      
      <div class="filter-item">
        <label>Urutkan:</label>
        <select id="sort-filter">
          <option value="ending">Berakhir Segera</option>
          <option value="price-low">Harga Terendah</option>
          <option value="price-high">Harga Tertinggi</option>
          <option value="bids">Bid Terbanyak</option>
        </select>
      </div>

      <div class="active-auctions-count">
        <i class="bi bi-fire"></i>
        <span><strong id="active-count">2</strong> Lelang Aktif</span>
      </div>
    </div>
  </section>

  <!-- LELANG ITEMS GRID -->
  <section class="lelang-items">
    <div class="lelang-container">
      
      <!-- Auction Item 1 - iPhone 15 Pro Max -->
      <div class="auction-item" data-category="iphone">
        <div class="auction-status hot">
          <i class="bi bi-fire"></i>
          <span>HOT</span>
        </div>
        <div class="auction-image">
          <img src="https://images.tokopedia.net/img/cache/700/VqbcmM/2023/10/27/e692ce96-2164-4c9c-9f58-b8dda1ef3037.jpg" alt="iPhone 15 Pro Max">
        </div>
        <div class="auction-details">
          <h3>iPhone 15 Pro Max 256GB</h3>
          <p class="auction-desc">
            <i class="bi bi-check-circle-fill"></i> Full Set • No Minus<br>
            <i class="bi bi-battery-charging"></i> Battery Health 90%
          </p>
          
          <div class="auction-price-info">
            <div class="price-row">
              <span class="price-label">Harga Pembukaan:</span>
              <span class="opening-price">Rp 15.000.000</span>
            </div>
            <div class="price-row highlight">
              <span class="price-label">Bid Tertinggi:</span>
              <span class="current-price">Rp 16.500.000</span>
            </div>
          </div>

          <div class="auction-stats-row">
            <div class="stat">
              <i class="bi bi-hammer"></i>
              <span>128 Bids</span>
            </div>
            <div class="stat">
              <i class="bi bi-eye-fill"></i>
              <span>1.2k Views</span>
            </div>
          </div>

          <div class="auction-timer" data-end-time="2">
            <i class="bi bi-clock-fill"></i>
            <span class="time-remaining">Berakhir dalam 1 jam 45 menit</span>
          </div>

          <button class="btn-bid" onclick='openBidModal("iPhone 15 Pro Max 256GB", 16500000, "auction-1")'>
            <i class="bi bi-gavel"></i>
            Pasang Bid Sekarang
          </button>
        </div>
      </div>

      <!-- Auction Item 2 - Samsung Galaxy S24 Ultra -->
      <div class="auction-item" data-category="android">
        <div class="auction-status">
          <i class="bi bi-star-fill"></i>
          <span>NEW</span>
        </div>
        <div class="auction-image">
          <img src="https://images.unsplash.com/photo-1610945415295-d9bbf067e59c?w=400" alt="Samsung S24 Ultra">
        </div>
        <div class="auction-details">
          <h3>Samsung Galaxy S24 Ultra 512GB</h3>
          <p class="auction-desc">
            <i class="bi bi-check-circle-fill"></i> Full Set • Garansi Resmi<br>
            <i class="bi bi-battery-charging"></i> Battery Health 95%
          </p>
          
          <div class="auction-price-info">
            <div class="price-row">
              <span class="price-label">Harga Pembukaan:</span>
              <span class="opening-price">Rp 14.000.000</span>
            </div>
            <div class="price-row highlight">
              <span class="price-label">Bid Tertinggi:</span>
              <span class="current-price">Rp 15.200.000</span>
            </div>
          </div>

          <div class="auction-stats-row">
            <div class="stat">
              <i class="bi bi-hammer"></i>
              <span>95 Bids</span>
            </div>
            <div class="stat">
              <i class="bi bi-eye-fill"></i>
              <span>890 Views</span>
            </div>
          </div>

          <div class="auction-timer" data-end-time="4.5">
            <i class="bi bi-clock-fill"></i>
            <span class="time-remaining">Berakhir dalam 4 jam 30 menit</span>
          </div>

          <button class="btn-bid" onclick='openBidModal("Samsung Galaxy S24 Ultra 512GB", 15200000, "auction-2")'>
            <i class="bi bi-gavel"></i>
            Pasang Bid Sekarang
          </button>
        </div>
      </div>

      <!-- Additional auction items... (sisanya sama seperti sebelumnya) -->

    </div>
  </section>

  <!-- BID MODAL (Updated dengan Deposit Info) -->
  <div id="bid-modal" class="modal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeBidModal()">&times;</span>
      
      <div class="modal-header">
        <i class="bi bi-gavel"></i>
        <h2>Pasang Bid</h2>
      </div>

      <div class="modal-body">
        <h3 id="modal-product-name">iPhone 15 Pro Max 256GB</h3>
        
        <!-- BID INFO BOX -->
        <div class="bid-info-box">
          <div class="bid-info-row">
            <span>Bid Tertinggi Saat Ini:</span>
            <strong id="modal-current-bid">Rp 16.500.000</strong>
          </div>
          <div class="bid-info-row">
            <span>Minimum Bid Increment:</span>
            <strong>Rp 100.000</strong>
          </div>
          <div class="bid-info-row">
            <span>Bid Minimum Anda:</span>
            <strong id="modal-min-bid">Rp 16.600.000</strong>
          </div>
        </div>

        <!-- DEPOSIT INFO SECTION -->
        <div class="deposit-info-section" id="deposit-info-section" style="display: none;">
          <div class="deposit-info-box">
            <h4><i class="bi bi-shield-check"></i> Informasi Deposit</h4>
            <div class="deposit-row">
              <span>Deposit Anda Saat Ini:</span>
              <strong id="current-deposit-amount" style="color: #00ffff;">Rp 0</strong>
            </div>
            <div class="deposit-row">
              <span>Deposit Diperlukan (50%):</span>
              <strong id="required-deposit-amount" style="color: #ffd700;">Rp 0</strong>
            </div>
            
            <!-- SHORTAGE ALERT -->
            <div class="deposit-shortage" id="deposit-shortage" style="display: none;">
              <i class="bi bi-exclamation-triangle-fill"></i>
              <div class="shortage-text">
                <h4>Deposit Tidak Cukup!</h4>
                <p>Anda perlu menambah deposit sebesar:</p>
              </div>
              <span class="shortage-amount" id="shortage-amount-display">Rp 0</span>
            </div>
            
            <!-- TOP-UP BUTTON -->
            <button class="btn-topup-deposit" onclick="openDepositModal()" style="width: 100%; margin-top: 15px; padding: 12px; background: linear-gradient(135deg, #ffd700, #ffed4e); color: #000; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px;">
              <i class="bi bi-wallet2"></i>
              Top-Up Deposit
            </button>
          </div>
        </div>

        <!-- BID INPUT GROUP -->
        <div class="bid-input-group">
          <label for="bid-amount">Masukkan Jumlah Bid Anda:</label>
          <div class="input-wrapper">
            <span class="currency">Rp</span>
            <input type="text" id="bid-amount" placeholder="16.600.000" />
          </div>
          <div class="quick-bid-buttons">
            <button onclick="quickBid(100000)">+100K</button>
            <button onclick="quickBid(500000)">+500K</button>
            <button onclick="quickBid(1000000)">+1JT</button>
          </div>
        </div>

        <!-- BID HISTORY -->
        <div class="bid-history">
          <h4><i class="bi bi-clock-history"></i> Riwayat Bid</h4>
          <div class="history-list" id="bid-history-list">
            <!-- History items will be loaded here -->
          </div>
        </div>

        <!-- TERMS CHECKBOX -->
        <div class="terms-checkbox">
          <input type="checkbox" id="agree-terms">
          <label for="agree-terms">Saya setuju dengan <a href="#">syarat dan ketentuan</a> lelang</label>
        </div>

        <!-- SUBMIT BUTTON -->
        <button class="btn-submit-bid" onclick="submitBid()">
          <i class="bi bi-check-circle-fill"></i>
          Konfirmasi Bid
        </button>
      </div>
    </div>
  </div>

  <!-- DEPOSIT MODAL (NEW) -->
  <div id="deposit-modal" class="deposit-modal">
    <div class="deposit-modal-content">
      <div class="deposit-modal-header">
        <i class="bi bi-wallet2"></i>
        <h2>Top-Up Deposit</h2>
        <button class="close-deposit-modal" onclick="closeDepositModal()">×</button>
      </div>

      <div class="deposit-modal-body">
        <!-- SUCCESS MESSAGE -->
        <div class="deposit-success-message" id="deposit-success-message">
          <i class="bi bi-check-circle-fill"></i>
          <p>Top-up deposit berhasil! Silakan lanjutkan bid Anda.</p>
        </div>

        <!-- DEPOSIT INFO CARD -->
        <div class="deposit-info-card">
          <div class="deposit-balance">
            <span class="balance-label">Deposit Saat Ini:</span>
            <span class="balance-amount" id="modal-current-deposit">Rp 0</span>
          </div>
          
          <div class="deposit-requirement">
            <span class="req-label">Deposit Diperlukan:</span>
            <span class="req-amount" id="modal-required-deposit">Rp 0</span>
          </div>
          
          <!-- SHORTAGE SECTION -->
          <div class="deposit-shortage" id="modal-shortage-section" style="display: none;">
            <i class="bi bi-exclamation-triangle-fill"></i>
            <div class="shortage-text">
              <h4>Kekurangan Deposit</h4>
              <p>Anda perlu top-up minimal:</p>
            </div>
            <span class="shortage-amount" id="modal-shortage-amount">Rp 0</span>
          </div>
        </div>

        <!-- TOP-UP SECTION -->
        <div class="topup-section">
          <h3><i class="bi bi-cash-stack"></i> Jumlah Top-Up</h3>
          
          <div class="topup-input-group">
            <label>Masukkan Jumlah (Min. Rp 100.000)</label>
            <div class="topup-input-wrapper">
              <span class="currency">Rp</span>
              <input type="text" id="topup-amount" placeholder="500.000">
            </div>
          </div>

          <!-- QUICK AMOUNTS -->
          <div class="quick-amounts">
            <button class="quick-amount-btn" onclick="selectQuickAmount(500000)">Rp 500.000</button>
            <button class="quick-amount-btn" onclick="selectQuickAmount(1000000)">Rp 1.000.000</button>
            <button class="quick-amount-btn" onclick="selectQuickAmount(2000000)">Rp 2.000.000</button>
            <button class="quick-amount-btn" onclick="selectQuickAmount(5000000)">Rp 5.000.000</button>
            <button class="quick-amount-btn" onclick="selectQuickAmount(10000000)">Rp 10.000.000</button>
            <button class="quick-amount-btn" onclick="selectQuickAmount(20000000)">Rp 20.000.000</button>
          </div>

          <!-- PAYMENT METHODS -->
          <h3><i class="bi bi-credit-card"></i> Metode Pembayaran</h3>
          <div class="payment-methods">
            <div class="payment-method-btn" onclick="selectPaymentMethod('Bank Transfer')">
              <i class="bi bi-bank"></i>
              <div class="payment-method-info">
                <h4>Bank Transfer</h4>
                <p>Instant verification</p>
              </div>
            </div>
            <div class="payment-method-btn" onclick="selectPaymentMethod('E-Wallet')">
              <i class="bi bi-phone"></i>
              <div class="payment-method-info">
                <h4>E-Wallet</h4>
                <p>OVO, GoPay, Dana</p>
              </div>
            </div>
          </div>
        </div>

        <!-- ACTION BUTTONS -->
        <div class="deposit-actions">
          <button class="btn-cancel-deposit" onclick="closeDepositModal()">Batal</button>
          <button class="btn-topup-now" onclick="processTopUp()">
            <i class="bi bi-check-circle-fill"></i>
            Konfirmasi Top-Up
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts - URUTAN PENTING -->
  <script src="users.js"></script>
  <script src="products-loader.js"></script>
  <script src="session-manager.js"></script>
  <script src="auth-handler.js"></script>
  <script src="notification-handler.js"></script>
  <script src="search-engine.js"></script>
  <script src="auction-timer.js"></script>
  <!-- TAMBAHKAN DEPOSIT SYSTEM -->
  <script src="deposit-system.js"></script>
  <!-- SCRIPT LELANG UPDATED -->
  <script src="lelang-integration.js"></script>
  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
  <script src="script.js"></script>
</body>
</html>